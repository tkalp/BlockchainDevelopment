### Chainlink Data Feeds
- Suppose we are building a DeFi dapp and want to give users the ability to withdraw ETH worth a certain amout of USD
- To fulfill this request, the smartk contract must know how much one Ether is worth
- One way to do this
	- JavaSript application can fetch this information, make requests to the **Binance public API**
	- But a smart contract can't do this directly
- Another way
	- Build a JS application ourselves, but then we are introducing a centralized point of failure!
	- We also couldn't just pull from Binance because again, single point of failure!
- The right way
	- Use a decentralized oracle network (DON)
	- Decentralized data sources

### Chain Link
- Chainlink is a frame for DONs and is a way toget data in from multiple sources across multiple oracles
- This DON aggregates data in a decentralized manner and places it on the blockchain in a smart contract ("price reference feed" or "data feed") for us to read from
- All we have to do is read from a contract on the Chainlink network that is constantly being updated
	- News
	- Prices
- Using Chailink Data Feeds is a way to cheaply, more accurately, and with more security gather data from the real world in this decentralized context
- Since data is coming from multiple sources, multiple people can partake in the ecosystem and it becomes **even cheaper than running a centralized oracle**
- Uses **Off-chain Reporting** to reach consensus on data off-chain and report the data in a cryptographhically proven single transaction back on-chain for users to digest
- Can then make protocols like **Synthetix**, **Aave**, and **Compound**

https://data.chain.link/

### Importing from NPM and Github
- We can import code from right outside our contracts
- Often times, we don't need to have every piece of code directly in project
- Can borrow from other application!
- We can either user GitHub or NPM 

https://github.com/smartcontractkit/chainlink/blob/master/contracts/src/v0.6/interfaces/AggregatorV3Interface.sol

https://www.npmjs.com/package/@chainlink/contracts

### AggregatorV3Interface
- For example, we can use the on-chain **Feeds Registry** which is an on-chain contract that keeps track of where all of the data feeds are
	- https://docs.chain.link/docs/feed-registry/
- Or we can use a contract address directly to access the feed
	- https://docs.chain.link/docs/reference-contracts/

- Our example involves finding the price of ETH in terms of USD, so we need to find the data feed with this information
- **IMPORTANT:** Each network will have a different address for eatch piece of data we would use. The address of the `ETH/USD` contract will be different on Mainnet Ethereum from Mainnet Polygon, from Rinkby, etc.
- For this example, w will use the Rinkeby test network
	- https://docs.chain.link/docs/ethereum-addresses/#Rinkeby%20Testnet
- Here's how we would start the contract
```solidity
pragma solidity ^0.6.7;

  
import "@chainlink/contracts/src/v0.6/interfaces/AggregatorV3Interface.sol";

  
contract PriceConsumerV3 {

	AggregatorV3Interface public priceFeed;

	constructor() public {
		priceFeed = AggregatorV3Interface(0x8A753747A1Fa494EC906cE90E9f37563A8AF630e);
	}
}
```

### Working with Tuples
- Now we have to retrieve the latest ETH price by calling the `latestRoundData` function of the `priceFeed` contract
- This function has all the information we are looking for
	- `roundId`: The round ID. Each price update gets a unique round ID
	- `answer`: The current pricer
	- `startedAt`: Timestamp of when the round started
	- `updatedAt`: Timestamp of when the round was updated.
	- `answeredInRound`: The round ID of the round in which the answer was computed

#### Tuples
- A `tuple` is `solidity` is a way to create syntatic grouping of expression
- If a function returns multiple variables, such as the `latestRoundData`, we consider the return type to be a `tuple` of many types

```solidity
function latestRoundData() external view returns (
	uint80 roundId,
	int256 answer,
	uint256 startedAt,
	uint256 updatedAt, 
	uint80 answeredInRound
);
```

- to use this function, we must assign a variable to each of these return values. We can do these in multiple ways
	- Get all of the values back or get a particular value back
```solidity
// saving all return variables
(uint80 roundId, int price, uint startedAt, uint updatedAt, uint80 answeredInRound) = priceFeed.latestRoundData(); 

// saving only the price variable
(,int price,,,) = priceFeed.latestRoundData();
```

### Chainlink Data Feeds Decimals
