## Truffle
- Most popular blockchain development framework
- Packed with lots of useful features
	- Easy smart contract compilation
	- automated ABI generation
	- Integrated smart contract testing
		- Support for **Mocha** and **Chai**
	- Support for multiple networks
		- Rinkeby, **Ethereum** or even to Loom

```bash
npm install truffle -g 
```

### Getting Started
- In order to initalize a truffle project, we have to run the command

```bash
truffle init
```

- This will create a set of folders that looks like the following structure

```
├── contracts
  ├── Migrations.sol
├── migrations
	├── 1_initial_migrations.js
└── test
truffle-config.js
truffle.js
```

#### Truffle's Default Directory Structure

`contracts`
- This is the place where Truffle expects to find all our smart contracts. 
- In order to keep the code organized, we can create nested folders such as `contracts/folders`
- **Note:** `truffle init` should automatically created the `Migrations.sol` contract

`migrations`
- A migration is a JavaScript file that tells **Truffle** how to deploy a smart contract

`test`
- This is where the unit tests go
	- Can be composed on JavaScript or Solidity
- Once a contract is deployed, it cannot be changed, making it essential that we test our smart contracts before we deploy them

`truffle.js` and `truffle-config.js`
- Config files to store the network settings for deployment
- Needs to have two config files because on Windows having both `truffle.js` and `truffle.exe` in the same folder causes conflicts
	- If you are using windows, delete `truffle.js` and use `truffle-config.js`
- <a href="https://trufflesuite.com/docs/truffle/reference/configuration" target= "_blank">Truffle Config Documentation</a>

- It is important to note to keep the file structure as is for two reasons
	- Truffle will not work as expected if you change it
	- Adhering to the standards will allow other developers to understand what is happening

#### truffle-hdwaller-provider
- We can use *Infura* to deploy code to **Ethereum** as well for these notes
- We can run the application without needing to set up our own Ethereum node or waller
- However, *Infura* does not manage the private keys
	- Can't sign transactions on our behalf
- We need to use `truffle-hdwallet-provider` to allow `Truffle` to sign our transactions

```bash
npm install truffle-hdwallet-provier
```
- Make sure you do this AFTER `npm install truffle` 
	- This is due to truffle expecting an empty directory on init

### Compiling the Source Code
- The **Ethereum Virtual Machine** can't directly understand Soldiity source code as we write it
- Thus we need to run a compiler that will "translate" our smart contract into machine-readable bytecode
- The VM will then execute the byecode and complete the actions required by the smart contract

#### Using the solidity compiler
- Devs managed to bake in some **nifty** features to compiler
- Imagine we wanted to modify the definintion of `add` in `SafeMath`

```solidity
function add(uint16 a, uint16 b) internal returns (uint16){
	uint16 c = a + b;
	assert(c >= a);
	return c;
}
```

- If we try to compile this, the compiler will throw a warning 

`Function state mutability can be restricted to view`

- What the compiler does is say that our function does not read or write from/to the blockchain and that we should use the `pure` modifier

Why is this important?
- Making a `pure` or `view` function saves us some gas
- These functions do not modify the state of the block, there is no need for miners to execute them
- To put it in a few words, `pure` and `view` functioned can be `call`ed for free

#### Compiling
- We need to put all of the contracts we have written into a contract folder
- We can then run `truffle compile` which will then create the build artifacts and place them in the `./build/contracts`
- For example, prior to compile we have the following structure

```
├── contracts
  ├── Migrations.sol
  ├── CrytoZombies.sol
  ├── erc721.sol
  ├── ownable.sol
  ├── safemath.sol
  ├── zombieattack.sol
  ├── zombiefactory.sol
  ├── zombiefeeding.sol
  ├── zombiehelper.sol
  ├── zombieownership.sol
├── migrations
	├── 1_initial_migrations.js
└── test
truffle-config.js
truffle.js
```

- Then we can run `truffle compile` and have our build artifacts

### Migrations
- Now before we deploy to the Ethereum network, we need to be testing constantly
	- Once the contract is on the network, we cannot change it
	- This is covered in [[1. Testing Smart Contracts with Truffle]]
	- 